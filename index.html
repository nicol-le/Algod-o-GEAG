<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Avaliação Algodão-Geag</title>
    <link rel="shortcut icon" type="imagex/png" href="Design sem nome (16).png">
    <style>
       * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }


        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            padding-top: 60px;
        }


        header {
            width: 100%;
            height: 60px;
            background-color: #003399;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 10;
        }


        .main-content {
            margin-top: 20px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }


        .app-container {
            max-width: 400px;
            padding: 20px;
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }


        .form-group {
            margin-bottom: 10px;
        }


        label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
        }


        input, textarea, select, button {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }


        button {
            background: #003399;
            color: #fff;
            border: none;
            cursor: pointer;
            margin-top: 10px;
        }


        button:hover {
            background: #0055cc;
        }


        .visualizacao-dados {
            margin-top: 20px;
            width: 100%;
            overflow-x: auto;
        }


        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }


        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }


        th {
            background-color: #003399;
            color: white;
        }


        #formPartesReprodutivas, #formOrganismos {
            display: none;
        }

    </style>
</head>
<body>
    <header>
        <h1>Avaliação Algodão-Geag</h1>
    </header>
    <div class="main-content">
        <div class="app-container">
            <h2>Selecione o tipo de avaliação:</h2>
            <div class="form-group">
                <button id="btnPartesReprodutivas">Partes Reprodutivas</button>
                <button id="btnOrganismos">Entomofauna</button>
            </div>
        </div>

        <!-- Formulário para Partes Reprodutivas -->
        <div id="formPartesReprodutivas" class="app-container" style="display: none;">
            <h3>Partes Reprodutivas</h3>
            <form id="formReprodutivas">
                <div class="form-group">
                    <label for="pragueiro">Pragueiro:</label>
                    <input type="text" id="pragueiro" placeholder="Digite o nome do pragueiro" required>
                </div>
                <div class="form-group">
                    <label for="data">Data:</label>
                    <input type="date" id="data" required>
                </div>
                <div class="form-group">
                    <label for="estagio">Estágio:</label>
                    <input type="text" id="estagio" placeholder="Digite o estágio" required>
                </div>
                <div class="form-group">
                    <label for="planta">Número de Planta:</label>
                    <input type="number" id="planta" placeholder="Digite o número da planta" required>
                </div>
                <div class="form-group">
                    <label for="botoes">Número de Botões:</label>
                    <input type="number" id="botoes" placeholder="Digite o número de botões" required>
                </div>
                <div class="form-group">
                    <label for="maca">Número de Maçãs:</label>
                    <input type="number" id="maca" placeholder="Digite o número de maçãs" required>
                </div>
                <div class="form-group">
                    <label for="capulhos">Número de Capulhos:</label>
                    <input type="number" id="capulhos" placeholder="Digite o número de capulhos" required>
                </div>
                <div class="form-group">
                    <label for="danosamostra">Danos:</label>
                    <select id="danosamostra">
                        <optgroup label="Botões">
                            <option value="BDBO">BDBO-Botão Bicudo Oviposição</option>
                            <option value="BDBA">BDBA-Botão Bicudo Alimentação</option>
                            <option value="BAN">BAN-Botão Abscisão Natural</option>
                            <option value="BOPD">BOPD-Botão Ovipositado Predado </option>
                            <option value="BDL">BDL-Botão Danificado Lagarta</option>
                            <option value="BD">BD-Botão Danificado</option>
                            <option value="FDVA">FDVA-Flor Danificada por Vaquinha</option>
                        </optgroup>
                        <optgroup label="Maçã">
                            <option value="MDBO">MDBO-Maçã Bicudo Oviposição<option>                        <option value="MDBA">MDBA-Maçã Bicudo Alimentação</option>
                            <option value="MDBA">MDBA-Maçã Bicudo Alimentação</option>
                            <option value="MAN">MAN-Maçã Abscisão Natural</option>
                            <option value="MOPD">MOPD-Maçã Ovipositado Predado </option>
                            <option value="MDL">MDL-Maçã Danificado Lagarta</option>
                            <option value="MD">MD-Maçã Danificado</option>
                            <option value="MBP">MBP-Maçã Bico de Papagaio</option>
                       </optgroup>
                       <optgroup label="Capulho">
                        <option value="CDBO">CDBO-Capulho Oviposição Bicudo</option>
                        <option value="CDBA">CDBA-Capulho Alimentação Bicudo</option>
                        <option value="CAN">CAN-Capulho Abscisão Natural</option>
                        <option value="CDF">CDF-Capulho Disturbio Funcional</option>
                        <option value="COPD">COPD-Capulho Ovipositado Predado </option>
                        <option value="CDL">CDL-Capulho Danificado Lagarta</option>
                        <option value="CD">CD-Capulho Danificado </option>
                    </optgroup>
                    <optgroup label="Outro">
                        <option value="outro">Outro</option>
                        <option value="carima">Carimã</option>
                        <option value="causa">Causa Desconhecida</option>
                    </optgroup>
                    </select>
                </div>
                <div class="form-group">
                    <label for="quantidadeDano">Quantidade de Danos:</label>
                    <input type="number" id="quantidadeDano" placeholder="Digite a quantidade de danos" required>
                </div>
                <button type="button" id="salvarReprodutivas">Salvar Dados</button>
                <button type="button" id="baixarReprodutivas">Baixar Dados (Excel)</button>
            </form>
            <div class="visualizacao-dados">
                <h4>Dados Salvos</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Pragueiro</th>
                            <th>Data</th>
                            <th>Estágio</th>
                            <th>Número da Planta</th>
                            <th>Número de Botões</th>
                            <th>Número de Maçãs</th>
                            <th>Número de Capulhos</th>
                            <th>Danos</th>
                            <th>Quantidade de Danos</th>
                        </tr>
                    </thead>
                    <tbody id="tabelaReprodutivas"></tbody>
                </table>
            </div>
        </div>

        <!-- Formulário para Organismos -->
        <div id="formOrganismos" class="app-container" style="display: none;">
            <h3>Entomofauna</h3>
            <form id="formOrganismosForm">
                <div class="form-group">
                    <label for="pragueiroOrganismos">Pragueiro:</label>
                    <input type="text" id="pragueiroOrganismos" placeholder="Digite o nome do pragueiro" required>
                </div>
                <div class="form-group">
                    <label for="dataOrganismos">Data:</label>
                    <input type="date" id="dataOrganismos" required>
                </div>
                <div class="form-group">
                    <label for="numeroPlanta">Número da Planta:</label>
                    <input type="number" id="numeroPlanta" placeholder="Digite o número da planta" required>
                </div>
                <div class="form-group">
                    <label for="tipoOrganismo">Tipo de Organismo:</label>
                    <select id="tipoOrganismo">
                        <option value="outros">Outros</option>
                        <optgroup label="Sugadores/Desfolhadores">
                            <option value="TRI">TRI-Tripes fitófago</option>
                            <option value="TRIP">TRIP-Tripes predador</option>
                            <option value="PER">PER-Percevejo desconhcido</option>
                            <option value="PERAP">PERAP-Edessa meditabunda</option>
                            <option value="PG">PG-Pulgão</option>
                            <option value="NFMB">NFMB-Ninfa mosca-branca</option>
                            <option value="MBA">AMB-Adulto mosca-branca</option>
                            <option value="LG">LGG-Lagarta desconhecida</option>
                            <option value="ANTC">ANTC-Anticarsia gemmatalis</option>
                            <option value="HEL">HEL-lagarta helicoverpa</option>
                           <option value="FAL">FAL-Falsa medideira</option>
                             <option value="PLU">PLU-Plutella xyllostella</option>
                             <option value="SPO">SPOD-Spodoptera spp.</option>
                        </optgroup>
                        <optgroup label="Polinizadores">
                            <option value="ABL">ABL-Abelha</option>
                            <option value="ASIR">ASIR-Adulto Sirfideo</option>
                            <option value="LSIR">LSIR-Larva Sirfideo</option>
                        </optgroup>
                        <optgroup label="Predadores e Parasitóides">
                            <option value="BLL">Larva Bicho-lixeiro</option>
                            <option value="BLA">Adulto Bicho-lixeiro</option>
                            <option value="OBL">Ovo bicho-lixeiro</option>
                            <option value="TES">TES-Tesourinha</option>
                            <option value="JOA">JOA-Joaninha</option>
                            <option value="CYC">JOC-Joaninha cycloneda</option>      
                            <option value="JP">JP-Joaninha Hipodamia</option>
                            <option value="LJ">LJ-Larva Joaninha</option>
                            <option value="LHIP">LHIP-Larva Joaninha Eriopis</option>
                            <option value="LCYC">LCYC-Larva Joaninha cycloneda</option>
                            <option value="LHIP">LHIP-Larva Joaninha Hipodamia</option>
                            <option value="ERIO">ERIO-Joaninha Eriopis</option>
                            <option value="PERO">PERO-Percevejo Orius</option>
                            <option value="PERP">PER-Percevejo predador</option>
                            <option value="ARN">ANT-Anthycidae</option>
                            <option value="ADOL">ADOL-Dolichopodidae</option>
                            <option value="FOR">FOR-Formiga</option>
                            <option value="ARA">ARA-Aranha Predadora</option>
                            <option value="REDU">REDU-Reduviidae</option>
                        </optgroup>
                    </select>
                </div>

                <div class="form-group">
                    <label for="quantidade">Quantidade:</label>
                    <input type="number" id="quantidade" placeholder="Digite a quantidade" required>
                </div>
                <div class="form-group">
                    <label for="observacoes">Observações:</label>
                    <textarea id="observacoes" placeholder="Digite observações"></textarea>
                </div>
                <button type="button" id="salvarOrganismos">Salvar Dados</button>
                <button type="button" id="baixarOrganismos">Baixar Dados (Excel)</button>
            </form>
            <div class="visualizacao-dados">
                <h4>Dados Salvos</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Pragueiro</th>
                            <th>Data</th>
                            <th>Número da Planta</th>
                            <th>Tipo de Organismo</th>
                            <th>Quantidade</th>
                            <th>Observações</th>
                        </tr>
                    </thead>
                    <tbody id="tabelaOrganismos"></tbody>
                </table>
            </div>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
       document.addEventListener('DOMContentLoaded', () => {
    const btnPartesReprodutivas = document.getElementById('btnPartesReprodutivas');
    const btnOrganismos = document.getElementById('btnOrganismos');
    const formPartesReprodutivas = document.getElementById('formPartesReprodutivas');
    const formOrganismos = document.getElementById('formOrganismos');

    // Função para alternar a visibilidade dos formulários
    const alternarFormulario = (formularioVisivel) => {
        if (formularioVisivel === 'PartesReprodutivas') {
            formPartesReprodutivas.style.display = 'block';
            formOrganismos.style.display = 'none';
        } else if (formularioVisivel === 'Organismos') {
            formPartesReprodutivas.style.display = 'none';
            formOrganismos.style.display = 'block';
        }
    };

    // Adicionar eventos aos botões
    btnPartesReprodutivas.addEventListener('click', () => {
        alternarFormulario('PartesReprodutivas');
    });

    btnOrganismos.addEventListener('click', () => {
        alternarFormulario('Organismos');
    });


            const salvarReprodutivasBtn = document.getElementById('salvarReprodutivas');
            const salvarOrganismosBtn = document.getElementById('salvarOrganismos');
            const baixarExcelBtn = document.getElementById('baixarExcel');
        
            let dadosReprodutivas = JSON.parse(localStorage.getItem('dadosReprodutivas')) || [];
            let dadosOrganismos = JSON.parse(localStorage.getItem('dadosOrganismos')) || [];
        
            const exibirMensagem = (mensagem, sucesso = true) => {
                const mensagemDiv = document.createElement('div');
                mensagemDiv.textContent = mensagem;
                mensagemDiv.style.marginTop = '10px';
                mensagemDiv.style.padding = '10px';
                mensagemDiv.style.borderRadius = '5px';
                mensagemDiv.style.color = '#fff';
                mensagemDiv.style.backgroundColor = sucesso ? '#4CAF50' : '#f44336';
                mensagemDiv.style.textAlign = 'center';
                formPartesReprodutivas.parentElement.insertBefore(mensagemDiv, formPartesReprodutivas);
        
                setTimeout(() => {
                    mensagemDiv.remove();
                }, 3000);
            };
        
            const atualizarTabelaReprodutivas = () => {
                tabelaReprodutivas.innerHTML = '';
                dadosReprodutivas.forEach((dado, index) => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${dado.pragueiro}</td>
                        <td>${dado.data}</td>
                        <td>${dado.estagio}</td>
                        <td>${dado.planta}</td>
                        <td>${dado.botoes}</td>
                        <td>${dado.macas}</td>
                        <td>${dado.capulhos}</td>
                        <td>${dado.danos}</td>
                        <td>${dado.quantidadeDano}</td>
                        <td><button class="excluirLinha" data-index="${index}">Excluir</button></td>
                    `;
                    tabelaReprodutivas.appendChild(tr);
                });
        
                document.querySelectorAll('.excluirLinha').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const index = e.target.dataset.index;
                        dadosReprodutivas.splice(index, 1);
                        localStorage.setItem('dadosReprodutivas', JSON.stringify(dadosReprodutivas));
                        atualizarTabelaReprodutivas();
                        exibirMensagem('Linha excluída com sucesso!');
                    });
                });
            };
        
            const atualizarTabelaOrganismos = () => {
                tabelaOrganismos.innerHTML = '';
                dadosOrganismos.forEach((dado, index) => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${dado.pragueiro}</td>
                        <td>${dado.data}</td>
                        <td>${dado.numeroPlanta}</td>
                        <td>${dado.tipoOrganismo}</td>
                        <td>${dado.quantidade}</td>
                        <td>${dado.observacoes || '—'}</td>
                        <td><button class="excluirLinha" data-index="${index}">Excluir</button></td>
                    `;
                    tabelaOrganismos.appendChild(tr);
                });
        
                document.querySelectorAll('.excluirLinha').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const index = e.target.dataset.index;
                        dadosOrganismos.splice(index, 1);
                        localStorage.setItem('dadosOrganismos', JSON.stringify(dadosOrganismos));
                        atualizarTabelaOrganismos();
                        exibirMensagem('Linha excluída com sucesso!');
                    });
                });
            };
            function baixarDados(dados, nomeArquivo) {
        const csvContent = [
            Object.keys(dados[0]).join(','), // Cabeçalhos
            ...dados.map(obj => Object.values(obj).join(',')) // Linhas
        ].join('\n');

        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.setAttribute('href', url);
        link.setAttribute('download', `${nomeArquivo}.csv`);
        link.style.visibility = 'hidden';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    }
            salvarReprodutivasBtn.addEventListener('click', () => {
                const novoDado = {
                    pragueiro: document.getElementById('pragueiro').value,
                    data: document.getElementById('data').value,
                    estagio: document.getElementById('estagio').value,
                    planta: document.getElementById('planta').value,
                    botoes: document.getElementById('botoes').value,
                    macas: document.getElementById('maca').value,
                    capulhos: document.getElementById('capulhos').value,
                    danos: document.getElementById('danosamostra').value,
                    quantidadeDano: document.getElementById('quantidadeDano').value,
                };
        
                if (Object.values(novoDado).some(campo => campo === '')) {
                    exibirMensagem('Preencha todos os campos!', false);
                    return;
                }
        
                dadosReprodutivas.push(novoDado);
                localStorage.setItem('dadosReprodutivas', JSON.stringify(dadosReprodutivas));
                atualizarTabelaReprodutivas();
                exibirMensagem('Dados de Partes Reprodutivas salvos com sucesso!');
            });
        
            salvarOrganismosBtn.addEventListener('click', () => {
                const novoDado = {
                    pragueiro: document.getElementById('pragueiroOrganismos').value,
                    data: document.getElementById('dataOrganismos').value,
                    numeroPlanta: document.getElementById('numeroPlanta').value,
                    tipoOrganismo: document.getElementById('tipoOrganismo').value,
                    quantidade: document.getElementById('quantidade').value,
                    observacoes: document.getElementById('observacoes').value || '',
                };
        
                if (Object.values(novoDado).some(campo => campo === '' && campo !== novoDado.observacoes)) {
                    exibirMensagem('Preencha todos os campos obrigatórios!', false);
                    return;
                }
        
                dadosOrganismos.push(novoDado);
                localStorage.setItem('dadosOrganismos', JSON.stringify(dadosOrganismos));
                atualizarTabelaOrganismos();
                exibirMensagem('Dados de Entomofauna salvos com sucesso!');
            });
        
         

        
            // Funções para alternar entre os formulários
            btnPartesReprodutivas.addEventListener('click', () => {
                formPartesReprodutivas.style.display = 'block';
                formOrganismos.style.display = 'none';
            });
        
            btnOrganismos.addEventListener('click', () => {
                formPartesReprodutivas.style.display = 'none';
                formOrganismos.style.display = 'block';
            });
            function baixarDados(dados, nomeArquivo) {
        const csvContent = [
            Object.keys(dados[0]).join(','), // Cabeçalhos
            ...dados.map(obj => Object.values(obj).join(',')) // Linhas
        ].join('\n');

        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.setAttribute('href', url);
        link.setAttribute('download', `${nomeArquivo}.csv`);
        link.style.visibility = 'hidden';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    }
        
            atualizarTabelaReprodutivas();
            atualizarTabelaOrganismos();
        });
        </script>
        
    

</body>
</html>
